import{b as w,d as x,e as y,g as C,i as B,z as F,j}from"./index-CLIP-deI.js";const L={}.hasOwnProperty;function A(e,n){let a=-1,t;if(n.extensions)for(;++a<n.extensions.length;)A(e,n.extensions[a]);for(t in n)if(L.call(n,t))switch(t){case"extensions":break;case"unsafe":{b(e[t],n[t]);break}case"join":{b(e[t],n[t]);break}case"handlers":{S(e[t],n[t]);break}default:e.options[t]=n[t]}return e}function b(e,n){n&&e.push(...n)}function S(e,n){n&&Object.assign(e,n)}const v=[I];function I(e,n,a,t){if(n.type==="code"&&w(n,t)&&(e.type==="list"||e.type===n.type&&w(e,t)))return!1;if("spread"in a&&typeof a.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&x(n,t))?void 0:a.spread?1:0}const k=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],T=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:k},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:k},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:k},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:k},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:k},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:k},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:k},{atBreak:!0,character:"~"}];function G(e){return e.label||!e.identifier?e.label||"":y(e.identifier)}function M(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function P(e,n,a){const t=n.indexStack,c=e.children||[],r=[];let i=-1,o=a.before,l;t.push(-1);let u=n.createTracker(a);for(;++i<c.length;){const s=c[i];let f;if(t[t.length-1]=i,i+1<c.length){let d=n.handle.handlers[c[i+1].type];d&&d.peek&&(d=d.peek),f=d?d(c[i+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else f=a.after;r.length>0&&(o==="\r"||o===`
`)&&s.type==="html"&&(r[r.length-1]=r[r.length-1].replace(/(\r?\n|\r)$/," "),o=" ",u=n.createTracker(a),u.move(r.join("")));let h=n.handle(s,e,n,{...u.current(),after:f,before:o});l&&l===h.slice(0,1)&&(h=C(l.charCodeAt(0))+h.slice(1));const p=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,l=void 0,p&&(r.length>0&&p.before&&o===r[r.length-1].slice(-1)&&(r[r.length-1]=r[r.length-1].slice(0,-1)+C(o.charCodeAt(0))),p.after&&(l=f)),u.move(h),r.push(h),o=h.slice(-1)}return t.pop(),r.join("")}function E(e,n,a){const t=n.indexStack,c=e.children||[],r=n.createTracker(a),i=[];let o=-1;for(t.push(-1);++o<c.length;){const l=c[o];t[t.length-1]=o,i.push(r.move(n.handle(l,e,n,{before:`
`,after:`
`,...r.current()}))),l.type!=="list"&&(n.bulletLastUsed=void 0),o<c.length-1&&i.push(r.move(z(l,c[o+1],e,n)))}return t.pop(),i.join("")}function z(e,n,a,t){let c=t.join.length;for(;c--;){const r=t.join[c](e,n,a,t);if(r===!0||r===1)break;if(typeof r=="number")return`
`.repeat(1+r);if(r===!1)return`

<!---->

`}return`

`}const R=/\r?\n|\r/g;function _(e,n){const a=[];let t=0,c=0,r;for(;r=R.exec(e);)i(e.slice(t,r.index)),a.push(r[0]),t=r.index+r[0].length,c++;return i(e.slice(t)),a.join("");function i(o){a.push(n(o,c,!o))}}function $(e,n,a){const t=(a.before||"")+(n||"")+(a.after||""),c=[],r=[],i={};let o=-1;for(;++o<e.unsafe.length;){const s=e.unsafe[o];if(!B(e.stack,s))continue;const f=e.compilePattern(s);let h;for(;h=f.exec(t);){const p="before"in s||!!s.atBreak,d="after"in s,g=h.index+(p?h[1].length:0);c.includes(g)?(i[g].before&&!p&&(i[g].before=!1),i[g].after&&!d&&(i[g].after=!1)):(c.push(g),i[g]={before:p,after:d})}}c.sort(D);let l=a.before?a.before.length:0;const u=t.length-(a.after?a.after.length:0);for(o=-1;++o<c.length;){const s=c[o];s<l||s>=u||s+1<u&&c[o+1]===s+1&&i[s].after&&!i[s+1].before&&!i[s+1].after||c[o-1]===s-1&&i[s].before&&!i[s-1].before&&!i[s-1].after||(l!==s&&r.push(m(t.slice(l,s),"\\")),l=s,/[!-/:-@[-`{-~]/.test(t.charAt(s))&&(!a.encode||!a.encode.includes(t.charAt(s)))?r.push("\\"):(r.push(C(t.charCodeAt(s))),l++))}return r.push(m(t.slice(l,u),a.after)),r.join("")}function D(e,n){return e-n}function m(e,n){const a=/\\(?=[!-/:-@[-`{-~])/g,t=[],c=[],r=e+n;let i=-1,o=0,l;for(;l=a.exec(r);)t.push(l.index);for(;++i<t.length;)o!==t[i]&&c.push(e.slice(o,t[i])),c.push("\\"),o=t[i];return c.push(e.slice(o)),c.join("")}function Z(e){const n=e||{},a=n.now||{};let t=n.lineShift||0,c=a.line||1,r=a.column||1;return{move:l,current:i,shift:o};function i(){return{now:{line:c,column:r},lineShift:t}}function o(u){t+=u}function l(u){const s=u||"",f=s.split(/\r?\n|\r/g),h=f[f.length-1];return c+=f.length-1,r=f.length===1?r+h.length:1+h.length+t,s}}function O(e,n){const a=n||{},t={associationId:G,containerPhrasing:q,containerFlow:J,createTracker:Z,compilePattern:M,enter:r,handlers:{...j},handle:void 0,indentLines:_,indexStack:[],join:[...v],options:{},safe:K,stack:[],unsafe:[...T]};A(t,a),t.options.tightDefinitions&&t.join.push(U),t.handle=F("type",{invalid:Q,unknown:H,handlers:t.handlers});let c=t.handle(e,void 0,t,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return c&&c.charCodeAt(c.length-1)!==10&&c.charCodeAt(c.length-1)!==13&&(c+=`
`),c;function r(i){return t.stack.push(i),o;function o(){t.stack.pop()}}}function Q(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function H(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function U(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function q(e,n){return P(e,this,n)}function J(e,n){return E(e,this,n)}function K(e,n){return $(this,e,n)}function V(e){const n=this;n.compiler=a;function a(t){return O(t,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}export{V as default};
